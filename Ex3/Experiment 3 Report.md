# Experiment 3 Report

## 第三章上机题6

我们实现了三个函数：

- `cholesky(...)`：输入一对称正定矩阵$A$，程序用平方根法计算其Cholesky分解$A=LL^T$，并返回下三角矩阵$L$；
- `hilbert(...)`：输入尺寸$n$，程序输出$n\times n$ Hilbert矩阵$H_n$；
- `solve_hilbert_system(...)`：输入尺寸$n$和（可选的）扰动$\Delta b$，程序利用Cholesky分解求解对应的线性方程组，并给出双精度下的残差和误差。若未给定扰动，则视扰动为零。

之后，我们按照要求构造了对应阶数的Hilbert矩阵，并生成了对应的方程组，对Hilbert矩阵进行Cholesky分解后便捷地计算出了方程组的解（因为计算$L$矩阵的逆很便捷），然后计算了$||\mathbf{r}||_\infty$和$||\mathbf{\Delta x}||_\infty$.

所有计算均在双精度浮点数下进行。

| 条件 | 残差无穷范数 | 解的相对误差 |
|:---:|:---:|:-:|
| N=10, 无扰动 | 1.8534e-4 | 7.00047e6 |
| N=10, 有扰动 | 1.0242e-4 | 7.01781e6 |
| N=8, 无扰动 | 1.9300e-7 | 2.16215e5 |
| N=12, 无扰动 | 1.3297e-2 | 2.35953e8 |
| N=13, 无扰动 | 1.2470e0| 7.39456e8 |
| N=14, 无扰动 | * | * |

（表中**有扰动**一行的数据为100次随机选择扰动后结果平均值。扰动由`numpy.random.rand()`生成。）

可以发现，随着Hilbert矩阵阶数提升，尽管残差仍然（相对）较小（或者说残差的爆发式增长来得较晚），但解的相对误差已经非常巨大。这验证了Hilbert矩阵作为稀疏矩阵的病态性。随机扰动引发的解的相对误差变化量相对于扰动的大小（以无穷范数计）也是巨大的（数量级约为$10^{13}$）。

当N=14时，采用单纯的双精度浮点数计算已经导致计算出现错误：

<image src="./images/failed_14.png">

在Cholesky分解的过程中，某一对角元素在减法过程中成为了负数，无法进行正常的平方根操作。这进一步说明了此问题的病态。