# Experiment 7 Report

## 第七章上机题4

### 复合Simpson公式

复合Simpson公式的余项为$-\frac{h^4}{2880}(b - a)· f^{(4)}(\eta)$. 现欲使绝对误差小于$0.5\times 10^{-8}$，代入上式并分别取$f_1(t) = \frac{1}{t},\ f_1^{(4)}(t) = \frac{24}{t^5} \le 24;\ f_2(t) = \frac{1}{1 + t^2},\ f_2^{(4)}(t) = \frac{24(5t^4 - 10t^2 + 1)}{(1 + t^2)^5} \le 24$,求得$h_1\le 2.7832\times 10^{-2}, h_2\le 1.9680\times 10^{-2}$.

程序实现需要注意边界情况：由于我们选取的h不一定恰好等分积分区间，因此最后一小段的Simpson公式系数可能小于h，需要单独处理。

| 表达式 | 参考值 | 程序计算结果 | 绝对误差大小 |
|:-:|:-:|:-:|:-:|
| ln2 | 0.6931471805599453 | 0.6931471817302685 | 1.1703e-09 |
| pi | 3.141592653589793 | 3.1415926535956142 | 5.8211e-12 |

$\ln 2$的误差基本与理论分析相符。$\pi$的误差相比理论分析小不少，但这是可以解释的：理论分析中，我们取$[0, 1]$上四次导数最大值$f^{(4)}(0) = 24$做估计，但实际上$\frac{1}{1 + t^2}$在原点附近的变化非常剧烈：

<image src="./images/der.png">

因此由于估计余项时$\eta$不确定，很有可能绝对值远小于24。我们估计的步长只能保证误差一定小于给定的误差限制，不能保证误差一定和误差限制差不多。

### 复合Gauss公式
复合Gauss公式的余项为$\frac{h^4}{4320}(b - a)· f^{(4)}(\xi_1)$. 现欲使绝对误差小于$0.5\times 10^{-8}$，利用与上一部分相似的计算可得$h_1\le 3.0801\times 10^{-2},\ h_2\le 2.1779\times 10^{-2}$，进而求出$n_1 \ge 32.467, n_2 \ge 45.915 \Rightarrow n_1\ge 33, n_2\ge46.$ 由于Gauss公式是等距分割，因此不需要担心边界情况。

| 表达式 | 参考值 | 程序计算结果 | 绝对误差大小 |
|:-:|:-:|:-:|:-:|
| ln2 | 0.6931471805599453 | 0.6931471794626659 | 1.0973e-9 |
| pi | 3.141592653589793 | 3.1415926535898406 | 4.7518e-14 |

两个程序运行结果：

<image src="./images/result.png">


